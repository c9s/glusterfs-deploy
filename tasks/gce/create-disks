#!/bin/bash
# CREATE N DISKS
# ===================================
source ./tasks/gce/config
set -e


echo "Creating $NUM_DISK_PER_INSTANCE disks on $N instances..."

declare -a pids=()
for ((i=1; i<=$N; i++))
do
    for ((di=1; di<=$NUM_DISK_PER_INSTANCE; di++))
    do
        gcloud_create_disk "$(gcloud:disk_name $i $di)" &
        pids+=($!)
    done
done

echo "Waiting for all disks get ready..."
wait "${pids[@]}"
